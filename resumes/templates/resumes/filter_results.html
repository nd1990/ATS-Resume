{% extends 'core/base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2 class="mb-1 text-accent">Filter Results â€“ Best Candidates</h2>
        <p class="text-secondary-c small mb-0">Sorted by match score (highest first). Generate full report for any candidate.</p>
    </div>
    <a href="{% url 'ai_filter' %}" class="btn btn-outline-light rounded-pill">New Scan</a>
</div>

<div class="card bg-transparent border-0">
    <div class="table-responsive">
        <table class="table table-dark table-hover align-middle mb-0" style="background-color: transparent;">
            <thead class="bg-card-bg">
                <tr>
                    <th class="py-3 ps-4 rounded-start">#</th>
                    <th class="py-3">Candidate</th>
                    <th class="py-3">Score</th>
                    <th class="py-3">Grade</th>
                    <th class="py-3">Recommendation</th>
                    <th class="py-3 pe-4 rounded-end text-end">Report</th>
                </tr>
            </thead>
            <tbody>
                {% for r in results %}
                <tr>
                    <td class="ps-4 text-secondary-c">{{ forloop.counter }}</td>
                    <td>
                        <span class="fw-bold text-white">{{ r.candidate_name }}</span>
                    </td>
                    <td>
                        <span class="text-accent fw-bold">{{ r.final_weighted_score }}%</span>
                    </td>
                    <td>
                        <span class="badge rounded-pill
                            {% if r.qa_grade == 'A' %}bg-success
                            {% elif r.qa_grade == 'B' %}bg-info
                            {% elif r.qa_grade == 'C' %}bg-warning text-dark
                            {% else %}bg-danger{% endif %}">
                            {{ r.qa_grade }}
                        </span>
                    </td>
                    <td>
                        <span class="badge
                            {% if r.recommendation == 'Hire' %}bg-success
                            {% elif r.recommendation == 'Hold' %}bg-warning text-dark
                            {% else %}bg-danger{% endif %}">
                            {{ r.recommendation }}
                        </span>
                    </td>
                    <td class="text-end pe-4">
                        <a href="{% url 'scan_report' r.pk %}" class="btn btn-sm btn-outline-light" target="_blank">View Report</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center py-5 text-secondary-c">No results in this scan.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
